
///////////////////////////////////////////////////
//Служебные функции и процедуры
///////////////////////////////////////////////////

&НаКлиенте
// контекст фреймворка Vanessa-Automation
Перем Ванесса;

&НаКлиенте
Перем ФормаНастройкиРаботыСБраузером;
 
&НаКлиенте
// Структура, в которой хранится состояние сценария между выполнением шагов. Очищается перед выполнением каждого сценария.
Перем Контекст Экспорт;
 
&НаКлиенте
// Структура, в которой можно хранить служебные данные между запусками сценариев. Существует, пока открыта форма Vanessa-Automation.
Перем КонтекстСохраняемый Экспорт;

&НаКлиенте
// Функция экспортирует список шагов, которые реализованы в данной внешней обработке.
Функция ПолучитьСписокТестов(КонтекстФреймворкаBDD) Экспорт
	Ванесса = КонтекстФреймворкаBDD;
	
	ВсеТесты = Новый Массив;

	//описание параметров
	//Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,Снипет,ИмяПроцедуры,ПредставлениеТеста,ОписаниеШага,ТипШага,Транзакция,Параметр);

	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯУстанавливаюТекстПоля(ID,ТекстПоля)","ВСтраницеБраузераДляЭлементаСIDЯУстанавливаюТекстПоля","И в странице браузера для элемента с ID ""ID"" я устанавливаю текст поля ""ТекстПоля""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"СтраницаБраузераСодержитТекст(ТекстHTML)","СтраницаБраузераСодержитТекст","И страница браузера содержит текст ""ТекстHTML""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯПолучаюТекстВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСIDЯПолучаюТекстВПеременную","И в странице браузера для элемента с ID ""ID"" я получаю текст в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯПолучаюСсылкуВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСIDЯПолучаюСсылкуВПеременную","И в странице браузера для элемента с ID ""ID"" я получаю ссылку в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСIDЯПолучаюТекстКнопкиВПеременную","И в странице браузера для элемента с ID ""ID"" я получаю текст кнопки в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСIDЯПолучаюСписокЗначенийВПеременную","И в странице браузера для элемента с ID ""ID"" я получаю список значений в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯДелаюПравыйКлик(Парам01)","ВСтраницеБраузераДляЭлементаСIDЯДелаюПравыйКлик","И в странице браузера для элемента с ID ""ID"" я делаю правый клик","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемЯПолучаюТекстВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемЯПолучаюТекстВПеременную","И в странице браузера для элемента с именем ""Name"" я получаю текст в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемЯПолучаюСсылкуВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемЯПолучаюСсылкуВПеременную","И в странице браузера для элемента с именем ""Name"" я получаю ссылку в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемЯПолучаюТекстКнопкиВПеременную","И в странице браузера для элемента с именем ""Name"" я получаю текст кнопки в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемЯУстанавливаюТекстПоля(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемЯУстанавливаюТекстПоля","И в странице браузера для элемента с именем ""Name"" я устанавливаю текст поля ""ТекстПоля""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемЯПолучаюСписокЗначенийВПеременную","И в странице браузера для элемента с именем ""Name"" я получаю список значений в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемЯВыбираюЗначениеВСпискеВыбора","И в странице браузера для элемента с именем ""Name"" я выбираю значение ""ЗначениеЭлемента"" в списке выбора","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемЯДелаюКлик(Парам01)","ВСтраницеБраузераДляЭлементаСИменемЯДелаюКлик","И в странице браузера для элемента с именем ""Name"" я делаю клик","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемЯДелаюПравыйКлик(Парам01)","ВСтраницеБраузераДляЭлементаСИменемЯДелаюПравыйКлик","И в странице браузера для элемента с именем ""Name"" я делаю правый клик","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюТекстВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюТекстВПеременную","И в странице браузера для элемента с именем класса ""className"" я получаю текст в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюСсылкуВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюСсылкуВПеременную","И в странице браузера для элемента с именем класса ""className"" я получаю ссылку в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюТекстКнопкиВПеременную","И в странице браузера для элемента с именем класса ""className"" я получаю текст кнопки в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемКлассаЯУстанавливаюТекстПоля(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемКлассаЯУстанавливаюТекстПоля","И в странице браузера для элемента с именем класса ""className"" я устанавливаю текст поля ""ТекстПоля""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюСписокЗначенийВПеременную","И в странице браузера для элемента с именем класса ""className"" я получаю список значений в переменную ""ИмяПеременной""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемКлассаЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСИменемКлассаЯВыбираюЗначениеВСпискеВыбора","И в странице браузера для элемента с именем класса ""className"" я выбираю значение ""ЗначениеЭлемента"" в списке выбора","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемКлассаЯДелаюКлик(Парам01)","ВСтраницеБраузераДляЭлементаСИменемКлассаЯДелаюКлик","И в странице браузера для элемента с именем класса ""className"" я делаю клик","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСИменемКлассаЯДелаюПравыйКлик(Парам01)","ВСтраницеБраузераДляЭлементаСИменемКлассаЯДелаюПравыйКлик","И в странице браузера для элемента с именем класса ""className"" я делаю правый клик","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ЯОткрываюСсылкуВеб_браузера(Парам01)","ЯОткрываюСсылкуВеб_браузера","И я открываю ссылку веб-браузера ""$ГрафикиОплатыinvoice_url$""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ЯРисуюПрямоугольникПоСсылкеВеб_браузера(ТабПарам)","ЯРисуюПрямоугольникПоСсылкеВеб_браузера","И я рисую прямоугольник по ссылке веб-браузера","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯУстанавливаюТекстПоля(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСIDЯУстанавливаюТекстПоля","И в странице браузера для элемента с ID ""number_card"" я устанавливаю текст поля ""4276160926645848""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02)","ВСтраницеБраузераДляЭлементаСIDЯВыбираюЗначениеВСпискеВыбора","И в странице браузера для элемента с ID ""month_card"" я выбираю значение ""05"" в списке выбора","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераЯПровожуСкроллККоординатам(Парам01,Парам02)","ВСтраницеБраузераЯПровожуСкроллККоординатам","И в странице браузера я провожу скролл к координатам ""500"" ""1000""","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ЯРисуюНадписьПоСсылкеВеб_браузера(ТабПарам)","ЯРисуюНадписьПоСсылкеВеб_браузера","И я рисую надпись по ссылке веб-браузера","","");
	Ванесса.ДобавитьШагВМассивТестов(ВсеТесты,"ВСтраницеБраузераДляЭлементаСIDЯДелаюКлик(Парам01)","ВСтраницеБраузераДляЭлементаСIDЯДелаюКлик","И в странице браузера для элемента с ID ""help_card_link"" я делаю клик","","");

	Возврат ВсеТесты;
КонецФункции
	
&НаСервере
// Служебная функция.
Функция ПолучитьМакетСервер(ИмяМакета)
	ОбъектСервер = РеквизитФормыВЗначение("Объект");
	Возврат ОбъектСервер.ПолучитьМакет(ИмяМакета);
КонецФункции
	
&НаКлиенте
// Служебная функция для подключения библиотеки создания fixtures.
Функция ПолучитьМакетОбработки(ИмяМакета) Экспорт
	Возврат ПолучитьМакетСервер(ИмяМакета);
КонецФункции



///////////////////////////////////////////////////
//Работа со сценариями
///////////////////////////////////////////////////

&НаКлиенте
// Функция выполняется перед началом каждого сценария
Функция ПередНачаломСценария() Экспорт
	
КонецФункции

&НаКлиенте
// Функция выполняется перед окончанием каждого сценария
Функция ПередОкончаниемСценария() Экспорт
	
КонецФункции



///////////////////////////////////////////////////
//Реализация шагов
///////////////////////////////////////////////////

&НаКлиенте
// Функция выполняется перед началом каждого сценария
Функция ЗапуститьБраузер()
	
	ФормаНастройкиРаботыСБраузером = Ванесса.ПолучитьМодульНастройкиРаботыСБраузером(Новый Структура("АсинхронныйПоискСуществованияФайлов", Ложь));
	
	ФайлБраузер = Новый Файл(ФормаНастройкиРаботыСБраузером.ИнтернетБраузер);
	Ванесса.TASKKILL(ФайлБраузер.Имя);
	
	СтрокаКоманды = """" + ФормаНастройкиРаботыСБраузером.ИнтернетБраузер + """ about:blank --remote-debugging-port=" + 
		Формат(ФормаНастройкиРаботыСБраузером.ПортБраузера, "ЧГ=");
	ЗапуститьПриложение(СтрокаКоманды);
	
КонецФункции


&НаКлиенте
//И я открываю ссылку веб-браузера "https://www.google.ru"
//@ЯОткрываюСсылкуВеб_браузера(Парам01)
Функция ЯОткрываюСсылкуВеб_браузера(Парам01) Экспорт
	
	Если ФормаНастройкиРаботыСБраузером = Неопределено Тогда
		ЗапуститьБраузер();
	КонецЕсли;
	
	ФормаНастройкиРаботыСБраузером.АдресВебКлиента = Парам01;
	ФормаНастройкиРаботыСБраузером.ОткрытьURL(Неопределено);
	
	Ванесса.СохранитьЗначениеВКонтекст("АдресВебСокет", ФормаНастройкиРаботыСБраузером.АдресВебСокет);
	
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	//ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И я рисую прямоугольник по ссылке веб-браузера
//@ЯРисуюПрямоугольникПоСсылкеВеб_браузера(ТабПарам)
Функция ЯРисуюПрямоугольникПоСсылкеВеб_браузера(ТабПарам) Экспорт
	//Ванесса.ПосмотретьЗначение(Истина);
	//ВызватьИсключение "Не реализовано.";
	
	ТекстШаблона = "{
	|    let node = document.createElement('div');
	|    node.style.fontSize = '100%';
	|    node.style.position = 'fixed';
	|    node.style.zIndex = 999999;
	|    node.style.left = '%ТочкаX%px';
	|    node.style.top = '%ТочкаY%px';
	|    node.style.width = '%Width%px';
	|    node.style.height = '%Height%px';
	|    node.style.borderWidth = '%borderWidth%';
	|    node.style.borderStyle = 'solid';
	|    node.style.borderColor = '%borderColor%';
	|    node.style.backgroundColor = '#11ffee00';
	|    node.style.padding = '1em';
	|    node.style.borderRadius = '1em';
	|    window.top.document.body.appendChild(node);
	|    setTimeout(() => { if (node) node.remove() }, %Длительность%);
	|};";
	
	ТекстJavaScript = ТекстШаблона;
	
	Для Каждого СтрокаПарам Из ТабПарам Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Кол1+"%", СтрокаПарам.Кол2)
	КонецЦикла;
	
	// Если значения параметров в шаге не заданы - ставим по умолчанию.
	ПараметрыУмолчания = Новый Структура("borderWidth,borderColor,Длительность","0.1em","red","10000");
	Для Каждого СтрокаПарам Из ПараметрыУмолчания Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Ключ+"%", СтрокаПарам.Значение)
	КонецЦикла;
	
	ФормаНастройкиРаботыСБраузером.ТекстJavaScript = ТекстJavaScript;
	ФормаНастройкиРаботыСБраузером.ВыполнитьJavaSctipt(Неопределено);

КонецФункции

&НаКлиенте
//И я рисую надпись по ссылке веб-браузера
//@ЯРисуюНадписьПоСсылкеВеб_браузера(Парам01,ТабПарам)
Функция ЯРисуюНадписьПоСсылкеВеб_браузера(ТабПарам) Экспорт
	
	//Ванесса.ПосмотретьЗначение(Истина);
	ТекстШаблона = "{
	|    let node = document.createElement('div');
	|    node.innerHTML = 
	|    '%НадписьТекст%';
	|    node.style.fontSize = '100%';
	|    node.style.position = 'fixed';
	|    node.style.zIndex = 999999;
	|    node.style.left = '%ТочкаX%px';
	|    node.style.top = '%ТочкаY%px';
	|    node.style.color = 'red';
	|    node.style.backgroundColor = '#11ffee00';
	|    node.style.padding = '1em';
	|    window.top.document.body.appendChild(node);
	|    setTimeout(() => { if (node) node.remove() }, %Длительность%);
	|};";   
	ТекстJavaScript = ТекстШаблона;
	
	Для Каждого СтрокаПарам Из ТабПарам Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Кол1+"%", СтрокаПарам.Кол2)
	КонецЦикла;
	
	// Если значения параметров в шаге не заданы - ставим по умолчанию.
	ПараметрыУмолчания = Новый Структура("color,Длительность","red","10000");
	Для Каждого СтрокаПарам Из ПараметрыУмолчания Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Ключ+"%", СтрокаПарам.Значение)
	КонецЦикла;
	
	ФормаНастройкиРаботыСБраузером.ТекстJavaScript = ТекстJavaScript;
	ФормаНастройкиРаботыСБраузером.ВыполнитьJavaSctipt(Неопределено);
	
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с ID "ID" я устанавливаю текст поля "ТекстПоля"
//@ВСтраницеБраузераДляЭлементаСIDЯУстанавливаюТекстПоля(ID,ТекстПоля)
Функция ВСтраницеБраузераДляЭлементаСIDЯУстанавливаюТекстПоля(ID,ТекстПоля) Экспорт

	ТекстШаблона = "{
	|    let node = document.getElementById('%ID%');
	|	 node.focus();
	|    node.value = '%ТекстПоля%';
	|};";
	
	ТекстJavaScript = ТекстШаблона;
	
	ТабПарам = Новый Структура("ID,ТекстПоля", ID,ТекстПоля);
	Для Каждого СтрокаПарам Из ТабПарам Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Ключ+"%", СтрокаПарам.Значение)
	КонецЦикла;
	
	ФормаНастройкиРаботыСБраузером.ТекстJavaScript = ТекстJavaScript;
	ФормаНастройкиРаботыСБраузером.ВыполнитьJavaSctipt(Неопределено);
	
КонецФункции

&НаКлиенте
//И страница браузера содержит текст "ТекстHTML"
//@СтраницаБраузераСодержитТекст(ТекстHTML)
Функция СтраницаБраузераСодержитТекст(ТекстHTML) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);

	HTMLСтраницы = ФормаНастройкиРаботыСБраузером.Элементы.ТекстHTML.Документ.documentElement.innerHTML; //
	Если Найти(HTMLСтраницы, ТекстHTML) = 0 Тогда
		ВызватьИсключение "Текст HTML на странице не найден";
	КонецЕсли;
	
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с ID "ID" я получаю текст в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСIDЯПолучаюТекстВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСIDЯПолучаюТекстВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	Element = ФормаНастройкиРаботыСБраузером.Элементы.ТекстHTML.Документ.getElementById(Парам01);
	Если Element.nodeName = "A" Тогда//ссылка
		Ванесса.СохранитьЗначениеВКонтекст(Парам02, Element.innerText);
	Иначе
		Ванесса.СохранитьЗначениеВКонтекст(Парам02, Element.value);
	КонецЕсли;
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с ID "ID" я получаю ссылку в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСIDЯПолучаюСсылкуВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСIDЯПолучаюСсылкуВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	Element = ФормаНастройкиРаботыСБраузером.Элементы.ТекстHTML.Документ.getElementById(Парам01);
	Ванесса.СохранитьЗначениеВКонтекст(Парам02, Element.href);
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с ID "ID" я получаю текст кнопки в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСIDЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСIDЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	Element = ФормаНастройкиРаботыСБраузером.Элементы.ТекстHTML.Документ.getElementById(Парам01);
	Ванесса.СохранитьЗначениеВКонтекст(Парам02, Element.value);
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с ID "ID" я получаю список значений в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСIDЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСIDЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02) Экспорт

	Element = ФормаНастройкиРаботыСБраузером.Элементы.ТекстHTML.Документ.getElementById(Парам01);
	ЗначениеСписок = Новый СписокЗначений;
	Для Каждого ТекЭлемент Из Element.options Цикл
		ЗначениеСписок.Добавить(ТекЭлемент.value, ТекЭлемент.text);
	КонецЦикла;
	Ванесса.СохранитьЗначениеВКонтекст(Парам02, ЗначениеСписок);
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с ID "ID" я выбираю значение "ЗначениеЭлемента" в списке выбора
//@ВСтраницеБраузераДляЭлементаСIDЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСIDЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ТекстШаблона = "{
	|    let node = document.getElementById('%ID%');
	|	 node.focus();
	|    node.value = '%ТекстПоля%';
	|};";
	
	ТекстJavaScript = ТекстШаблона;
	
	ТабПарам = Новый Структура("ID,ТекстПоля", Парам01,Парам02);
	Для Каждого СтрокаПарам Из ТабПарам Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Ключ+"%", СтрокаПарам.Значение)
	КонецЦикла;
	
	ФормаНастройкиРаботыСБраузером.ТекстJavaScript = ТекстJavaScript;
	ФормаНастройкиРаботыСБраузером.ВыполнитьJavaSctipt(Неопределено);
	
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с ID "ID" я делаю клик
//@ВСтраницеБраузераДляЭлементаСIDЯДелаюКлик(Парам01)
Функция ВСтраницеБраузераДляЭлементаСIDЯДелаюКлик(Парам01) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ТекстШаблона = "{
	|    let node = document.getElementById('%ID%');
	|	 node.focus();
	|    node.click();
	|};";
	
	ТекстJavaScript = ТекстШаблона;
	
	ТабПарам = Новый Структура("ID", Парам01);
	Для Каждого СтрокаПарам Из ТабПарам Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Ключ+"%", СтрокаПарам.Значение)
	КонецЦикла;
	
	ФормаНастройкиРаботыСБраузером.ТекстJavaScript = ТекстJavaScript;
	ФормаНастройкиРаботыСБраузером.ВыполнитьJavaSctipt(Неопределено);
	
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с ID "ID" я делаю правый клик
//@ВСтраницеБраузераДляЭлементаСIDЯДелаюПравыйКлик(Парам01)
Функция ВСтраницеБраузераДляЭлементаСIDЯДелаюПравыйКлик(Парам01) Экспорт
	ТекстШаблона = "{
	|    let node = document.getElementById('%ID%');
	|	 node.focus();
	|    node.contextMenu();
	|};";
	
	ТекстJavaScript = ТекстШаблона;
	
	ТабПарам = Новый Структура("ID", Парам01);
	Для Каждого СтрокаПарам Из ТабПарам Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Ключ+"%", СтрокаПарам.Значение)
	КонецЦикла;
	
	ФормаНастройкиРаботыСБраузером.ТекстJavaScript = ТекстJavaScript;
	ФормаНастройкиРаботыСБраузером.ВыполнитьJavaSctipt(Неопределено);
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем "Name" я получаю текст в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСИменемЯПолучаюТекстВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемЯПолучаюТекстВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем "Name" я получаю ссылку в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСИменемЯПолучаюСсылкуВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемЯПолучаюСсылкуВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем "Name" я получаю текст кнопки в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСИменемЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем "Name" я устанавливаю текст поля "ТекстПоля"
//@ВСтраницеБраузераДляЭлементаСИменемЯУстанавливаюТекстПоля(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемЯУстанавливаюТекстПоля(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем "Name" я получаю список значений в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСИменемЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем "Name" я выбираю значение "ЗначениеЭлемента" в списке выбора
//@ВСтраницеБраузераДляЭлементаСИменемЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем "Name" я делаю клик
//@ВСтраницеБраузераДляЭлементаСИменемЯДелаюКлик(Парам01)
Функция ВСтраницеБраузераДляЭлементаСИменемЯДелаюКлик(Парам01) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем "Name" я делаю правый клик
//@ВСтраницеБраузераДляЭлементаСИменемЯДелаюПравыйКлик(Парам01)
Функция ВСтраницеБраузераДляЭлементаСИменемЯДелаюПравыйКлик(Парам01) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем класса "className" я получаю текст в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюТекстВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюТекстВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем класса "className" я получаю ссылку в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюСсылкуВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюСсылкуВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем класса "className" я получаю текст кнопки в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюТекстКнопкиВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем класса "className" я устанавливаю текст поля "ТекстПоля"
//@ВСтраницеБраузераДляЭлементаСИменемКлассаЯУстанавливаюТекстПоля(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемКлассаЯУстанавливаюТекстПоля(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем класса "className" я получаю список значений в переменную "ИмяПеременной"
//@ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемКлассаЯПолучаюСписокЗначенийВПеременную(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем класса "className" я выбираю значение "ЗначениеЭлемента" в списке выбора
//@ВСтраницеБраузераДляЭлементаСИменемКлассаЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02)
Функция ВСтраницеБраузераДляЭлементаСИменемКлассаЯВыбираюЗначениеВСпискеВыбора(Парам01,Парам02) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем класса "className" я делаю клик
//@ВСтраницеБраузераДляЭлементаСИменемКлассаЯДелаюКлик(Парам01)
Функция ВСтраницеБраузераДляЭлементаСИменемКлассаЯДелаюКлик(Парам01) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера для элемента с именем класса "className" я делаю правый клик
//@ВСтраницеБраузераДляЭлементаСИменемКлассаЯДелаюПравыйКлик(Парам01)
Функция ВСтраницеБраузераДляЭлементаСИменемКлассаЯДелаюПравыйКлик(Парам01) Экспорт
	//Ванесса.ПосмотретьЗначение(Парам01,Истина);
	ВызватьИсключение "Не реализовано.";
КонецФункции

&НаКлиенте
//И в странице браузера я провожу скролл к координатам "500" "1000"
//@ВСтраницеБраузераЯПровожуСкроллККоординатам(Парам01,Парам02)
Функция ВСтраницеБраузераЯПровожуСкроллККоординатам(Парам01,Парам02) Экспорт
	
	ТекстШаблона = "{
	|	 window.scrollTo(%ТочкаX%, %ТочкаY%);
	|};";
	
	ТекстJavaScript = ТекстШаблона;
	
	ТабПарам = Новый Структура("ТочкаX,ТочкаY", Парам01,Парам02);
	Для Каждого СтрокаПарам Из ТабПарам Цикл
		ТекстJavaScript = СтрЗаменить(ТекстJavaScript, "%"+СтрокаПарам.Ключ+"%", СтрокаПарам.Значение)
	КонецЦикла;
	
	ФормаНастройкиРаботыСБраузером.ТекстJavaScript = ТекстJavaScript;
	ФормаНастройкиРаботыСБраузером.ВыполнитьJavaSctipt(Неопределено);
	
КонецФункции
